# Inquiry AI Assistant - å®ç°æ–¹æ¡ˆ

> åŸºäº Chrome Side Panel çš„å¤šå¹³å°ç”µå•†å®¢æœ AI åŠ©æ‰‹

## é¡¹ç›®æ¦‚è¿°

### ç›®æ ‡

- å¤åˆ» [Ant Design X Copilot](https://x.ant.design/docs/playground/copilot-cn) æ ·å¼çš„ AI åŠ©æ‰‹
- æ”¯æŒå¤šå¹³å°ï¼šRakuten R-Messe â†’ ç…¤ç‚‰ â†’ Amazon
- æ¯ä¸ªé—®è¯¢ç‹¬ç«‹å¯¹è¯ä¸Šä¸‹æ–‡
- æŠ“å–é¡µé¢æ•°æ® + AI ç”Ÿæˆå›å¤ + ä¸€é”®å¡«å……

### ä¸ºä»€ä¹ˆé€‰æ‹© Side Panel

| å¯¹æ¯”é¡¹ | æ‚¬æµ®é¢æ¿ (Plasmo) | Side Panel | Popup |
|--------|-------------------|------------|-------|
| å®ç°éš¾åº¦ | â­â­â­â­â­ | â­â­ | â­ |
| ç¾è§‚åº¦ | â­â­â­ | â­â­â­â­â­ | â­â­â­ |
| ä¸Šä¸‹æ–‡ç®¡ç† | â­â­â­ | â­â­â­â­â­ | â­â­ |
| å¤šå¹³å°æ‰©å±• | â­â­ | â­â­â­â­â­ | â­â­â­â­ |
| Shadow DOM | å¿…é¡»å¤„ç† | æ— éœ€ | æ— éœ€ |

**ç»“è®º**: Side Panel ç»¼åˆè¯„åˆ†æœ€é«˜ï¼Œç‹¬ç«‹é¡µé¢æ— æ ·å¼éš”ç¦»é—®é¢˜ã€‚

---

## æŠ€æœ¯æ ˆ

### æ„å»ºå·¥å…·é€‰å‹

#### ä¸ºä»€ä¹ˆé€‰æ‹© WXT

| å·¥å…· | çŠ¶æ€ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| **WXT** | âœ… æ´»è·ƒç»´æŠ¤ï¼Œæ¨è | ç°ä»£ DXã€æ¡†æ¶æ— å…³ã€è·¨æµè§ˆå™¨ã€åŸºäº Vite | è¾ƒæ–° |
| **Plasmo** | âš ï¸ ç»´æŠ¤æ¨¡å¼ | React ä¼˜å…ˆã€å¼€ç®±å³ç”¨ | ä½¿ç”¨ Parcelï¼ˆæ…¢ï¼‰ã€ç»´æŠ¤è€…ä¸æ´»è·ƒ |
| **CRXJS** | âš ï¸ Beta é˜¶æ®µ | HMR æä½³ã€è½»é‡ | å†å²ä¸ç¨³å®šã€ä»åœ¨ beta |

**WXT æ ¸å¿ƒä¼˜åŠ¿**ï¼š

1. **åŸºäº Vite** - æå¿«çš„ HMRï¼Œé¿å… Plasmo çš„ Parcel é—®é¢˜
2. **æ¡†æ¶æ— å…³** - æ”¯æŒ React/Vue/Svelte/Solid
3. **è·¨æµè§ˆå™¨** - Chrome/Firefox/Edge/Safariï¼Œå•ä¸€ä»£ç åº“
4. **MV2 + MV3** - ä¸¤ç§ Manifest éƒ½æ”¯æŒ
5. **è‡ªåŠ¨ Manifest** - æ–‡ä»¶ç³»ç»Ÿå³è·¯ç”±ï¼Œå‡å°‘é…ç½®
6. **æ´»è·ƒç»´æŠ¤** - ç¤¾åŒºæ´»è·ƒï¼ŒæŒç»­æ›´æ–°
7. **é«˜æ•ˆæ‰“åŒ…** - tree-shaking æ¯” Plasmo æ›´å¥½

### æ ¸å¿ƒä¾èµ–

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **æ„å»ºæ¡†æ¶** | WXT | ^0.20.0 | æµè§ˆå™¨æ‰©å±•å¼€å‘æ¡†æ¶ |
| **UI æ¡†æ¶** | React | ^19.2.3 | ç»„ä»¶åŒ–å¼€å‘ |
| **UI ä¸»åº“** | antd | ^6.2.2 | åŸºç¡€ UI ç»„ä»¶ |
| **AI ç»„ä»¶** | @ant-design/x | ^2.2.1 | Bubble, Sender, Prompts ç­‰ |
| **AI SDK** | @ant-design/x-sdk | ^2.2.1 | useXChat, XRequest |
| **Markdown** | @xspark/chat-markdown | ^0.1.0 | AI å›å¤æ¸²æŸ“ |
| **å›¾æ ‡** | @ant-design/icons | ^6.1.0 | å›¾æ ‡åº“ |
| **çŠ¶æ€ç®¡ç†** | Zustand | ^5.0.0 | è½»é‡çŠ¶æ€ + æŒä¹…åŒ– |
| **æ ·å¼** | Tailwind CSS | ^4.0.0 | åŸå­åŒ– CSS |
| **ç±»å‹** | TypeScript | ^5.9.3 | ç±»å‹å®‰å…¨ |
| **æ—¥æœŸ** | dayjs | ^1.11.19 | æ—¥æœŸå¤„ç† |

### Ant Design ç”Ÿæ€åˆ†å·¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  antd (ä¸»åº“)                                                        â”‚
â”‚  - Layout, Sider, Content           å¸ƒå±€                            â”‚
â”‚  - Menu, Tabs                       å¯¼èˆª                            â”‚
â”‚  - Card, Typography, Avatar         æ•°æ®å±•ç¤º                        â”‚
â”‚  - Button, Input, Select, Switch    è¡¨å•æ§ä»¶                        â”‚
â”‚  - Modal, Drawer, message           åé¦ˆ                            â”‚
â”‚  - ConfigProvider, theme            ä¸»é¢˜é…ç½®                        â”‚
â”‚  - Tooltip, Popconfirm, Dropdown    äº¤äº’å¢å¼º                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @ant-design/x (AI ä¸“ç”¨ç»„ä»¶)                                        â”‚
â”‚  - Bubble / Bubble.List             æ¶ˆæ¯æ°”æ³¡                        â”‚
â”‚  - Sender                           è¾“å…¥æ¡† + å‘é€                   â”‚
â”‚  - Prompts                          å¿«æ·æç¤º                        â”‚
â”‚  - Conversations                    å¯¹è¯åˆ—è¡¨                        â”‚
â”‚  - Welcome                          æ¬¢è¿/ç©ºçŠ¶æ€                     â”‚
â”‚  - ThoughtChain                     æ€ç»´é“¾å±•ç¤º                      â”‚
â”‚  - XProvider                        å…¨å±€ AI ä¸Šä¸‹æ–‡                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @ant-design/x-sdk (AI è¿è¡Œæ—¶)                                      â”‚
â”‚  - useXChat                         èŠå¤©çŠ¶æ€ç®¡ç† Hook               â”‚
â”‚  - useXAgent                        Agent è°ƒç”¨ Hook                 â”‚
â”‚  - XRequest                         æµå¼è¯·æ±‚å°è£…                    â”‚
â”‚  - XStream                          SSE æµè§£æ                      â”‚
â”‚  - OpenAIChatProvider               OpenAI é€‚é…å™¨                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @xspark/chat-markdown (Markdown)                                   â”‚
â”‚  - Markdown æ¸²æŸ“ (GFM)                                              â”‚
â”‚  - ä»£ç é«˜äº® (Shiki)                                                 â”‚
â”‚  - å¤åˆ¶ä»£ç æŒ‰é’®                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @ant-design/icons                                                  â”‚
â”‚  - RobotOutlined, UserOutlined, SendOutlined                        â”‚
â”‚  - CopyOutlined, FormOutlined, SettingOutlined                      â”‚
â”‚  - DeleteOutlined, PlusOutlined, etc.                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é¡¹ç›®ç»“æ„

```
inquiry-ai-assistant/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ entrypoints/                # WXT å…¥å£ç‚¹ (è‡ªåŠ¨è¯†åˆ«)
â”‚   â”‚   â”œâ”€â”€ sidepanel/              # Side Panel ä¸»ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html          # HTML å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ main.tsx            # React å…¥å£
â”‚   â”‚   â”‚   â””â”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ background.ts           # Service Worker
â”‚   â”‚   â””â”€â”€ content.ts              # Content Script
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                 # UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatPanel/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx           # èŠå¤©ä¸»é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageBubble.tsx   # æ¶ˆæ¯æ°”æ³¡
â”‚   â”‚   â”‚   â”œâ”€â”€ QuickPrompts.tsx    # å¿«æ·æ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ ContextCard.tsx     # é—®è¯¢ä¸Šä¸‹æ–‡å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ConversationList/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx           # å¯¹è¯åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ ConversationItem.tsx
â”‚   â”‚   â”œâ”€â”€ Settings/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx           # è®¾ç½®é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ ProviderConfig.tsx  # AI Provider é…ç½®
â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚       â”œâ”€â”€ Header.tsx          # é¡¶éƒ¨æ ‡é¢˜æ 
â”‚   â”‚       â””â”€â”€ EmptyState.tsx      # ç©ºçŠ¶æ€ (Welcome)
â”‚   â”‚
â”‚   â”œâ”€â”€ extractors/                 # å¤šå¹³å°æ•°æ®æå–å™¨
â”‚   â”‚   â”œâ”€â”€ types.ts                # ç»Ÿä¸€æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ factory.ts              # å·¥å‚æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ rakuten.ts              # Rakuten R-Messe
â”‚   â”‚   â”œâ”€â”€ mercari.ts              # ç…¤ç‚‰ (é¢„ç•™)
â”‚   â”‚   â””â”€â”€ amazon.ts               # Amazon (é¢„ç•™)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                   # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts            # AI æ¥å£ç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ provider-factory.ts # Provider å·¥å‚
â”‚   â”‚   â”‚   â”œâ”€â”€ openai.ts           # OpenAI å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ gemini.ts           # Gemini å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ custom.ts           # è‡ªå®šä¹‰ API
â”‚   â”‚   â””â”€â”€ storage.ts              # chrome.storage å°è£…
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                     # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ conversation.ts         # å¯¹è¯çŠ¶æ€ (æ ¸å¿ƒ)
â”‚   â”‚   â”œâ”€â”€ settings.ts             # è®¾ç½®çŠ¶æ€
â”‚   â”‚   â””â”€â”€ ui.ts                   # UI çŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ global.css              # Tailwind + å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â””â”€â”€ types/                      # TypeScript ç±»å‹
â”‚       â”œâ”€â”€ inquiry.ts              # é—®è¯¢æ•°æ®ç±»å‹
â”‚       â”œâ”€â”€ message.ts              # æ¶ˆæ¯ç±»å‹
â”‚       â””â”€â”€ platform.ts             # å¹³å°ç±»å‹
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icons/
â”‚       â”œâ”€â”€ icon-16.png
â”‚       â”œâ”€â”€ icon-48.png
â”‚       â””â”€â”€ icon-128.png
â”‚
â”œâ”€â”€ wxt.config.ts                   # WXT é…ç½®
â”œâ”€â”€ tailwind.config.ts              # Tailwind é…ç½®
â”œâ”€â”€ postcss.config.js               # PostCSS é…ç½®
â”œâ”€â”€ tsconfig.json                   # TypeScript é…ç½®
â””â”€â”€ package.json                    # ä¾èµ–é…ç½®
```

---

## æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Chrome Extension (MV3)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Side Panel (ç‹¬ç«‹ HTML)                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                   App.tsx                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  ConversationList        â”‚  ChatPanel               â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ ğŸŸ¢ å®¢æˆ·A (æ´»è·ƒ)     â”‚ â”‚  â”‚  Bubble.List        â”‚ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ âšª å®¢æˆ·B           â”‚ â”‚  â”‚  (Markdown æ¸²æŸ“)     â”‚ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ âšª å®¢æˆ·C           â”‚ â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  Prompts            â”‚ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                          â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                          â”‚  â”‚  Sender             â”‚ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                      â”‚
â”‚                    chrome.runtime.sendMessage                           â”‚
â”‚                                   â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Background Service Worker                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ AI Provider     â”‚  â”‚ Conversation    â”‚  â”‚ Tab Watcher      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ Manager         â”‚  â”‚ Store           â”‚  â”‚ (ç›‘å¬é¡µé¢åˆ‡æ¢)    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ - OpenAI        â”‚  â”‚ - æŒ‰é—®è¯¢IDå­˜å‚¨   â”‚  â”‚                  â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ - Gemini        â”‚  â”‚ - å†å²è®°å½•      â”‚  â”‚                  â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ - Custom        â”‚  â”‚                 â”‚  â”‚                  â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                      â”‚
â”‚                    chrome.tabs.sendMessage                              â”‚
â”‚                                   â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      Content Scripts                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚                    Extractor Factory                        â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Rakuten    â”‚ â”‚   Mercari   â”‚ â”‚   Amazon    â”‚  ...      â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Extractor  â”‚ â”‚  Extractor  â”‚ â”‚  Extractor  â”‚           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ - æŠ“å–é—®è¯¢   â”‚ â”‚ - æŠ“å–é—®è¯¢   â”‚ â”‚ - æŠ“å–é—®è¯¢   â”‚           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ - å¡«å……å›å¤   â”‚ â”‚ - å¡«å……å›å¤   â”‚ â”‚ - å¡«å……å›å¤   â”‚           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
ç”¨æˆ·æ‰“å¼€é—®è¯¢é¡µé¢
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Content Script (content.ts)        â”‚
â”‚  1. æ£€æµ‹å¹³å° (Rakuten/Mercari/...)  â”‚
â”‚  2. è°ƒç”¨å¯¹åº” Extractor              â”‚
â”‚  3. æå–é—®è¯¢æ•°æ®                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ chrome.runtime.sendMessage
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Background Service Worker          â”‚
â”‚  1. æ¥æ”¶é¡µé¢æ•°æ®                    â”‚
â”‚  2. é€šçŸ¥ Side Panel                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ chrome.runtime.sendMessage
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Side Panel                         â”‚
â”‚  1. æŸ¥æ‰¾æˆ–åˆ›å»ºå¯¹è¯ (by inquiryId)   â”‚
â”‚  2. åˆ‡æ¢åˆ°å¯¹åº”å¯¹è¯ä¸Šä¸‹æ–‡             â”‚
â”‚  3. æ˜¾ç¤ºé—®è¯¢ä¿¡æ¯                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ ç”¨æˆ·å‘é€æ¶ˆæ¯
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  useXChat Hook                      â”‚
â”‚  1. æ„å»ºæ¶ˆæ¯ (å« systemPrompt)      â”‚
â”‚  2. è°ƒç”¨ AI Provider                â”‚
â”‚  3. æµå¼æ¥æ”¶å“åº”                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ChatPanel                          â”‚
â”‚  1. Markdown æ¸²æŸ“ AI å›å¤           â”‚
â”‚  2. ç”¨æˆ·ç‚¹å‡»"å¡«å……"æŒ‰é’®              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ chrome.tabs.sendMessage
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Content Script                     â”‚
â”‚  è°ƒç”¨ extractor.fillReply()         â”‚
â”‚  å¡«å……åˆ°é¡µé¢å›å¤æ¡†                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒæ¥å£è®¾è®¡

### é—®è¯¢æ•°æ®ç±»å‹

```typescript
// src/types/inquiry.ts
export type Platform = 'rakuten' | 'mercari' | 'amazon'

export interface InquiryData {
  platform: Platform
  inquiryId: string
  customerName: string
  category?: string
  inquiryContent: string
  orderNumber?: string
  receivedTime?: string
  additionalInfo?: Record<string, string>
}
```

### å¹³å°æå–å™¨æ¥å£

```typescript
// src/extractors/types.ts
export interface PlatformExtractor {
  platform: Platform

  // æ£€æµ‹å½“å‰é¡µé¢æ˜¯å¦åŒ¹é…
  match(url: string): boolean

  // æå–é—®è¯¢æ•°æ®
  extract(): Promise<InquiryData | null>

  // å¡«å……å›å¤åˆ°é¡µé¢
  fillReply(content: string): Promise<boolean>

  // è·å–å”¯ä¸€é—®è¯¢ ID
  getInquiryId(): string | null
}
```

### å¯¹è¯å­˜å‚¨ç»“æ„

```typescript
// src/stores/conversation.ts
interface Message {
  id: string
  role: 'user' | 'assistant' | 'system'
  content: string
  timestamp: number
}

interface Conversation {
  id: string                    // æ ¼å¼: "platform:inquiryId"
  platform: Platform
  inquiryId: string
  customerName: string
  inquiryContent: string
  messages: Message[]
  systemPrompt: string
  createdAt: number
  updatedAt: number
}

interface ConversationStore {
  conversations: Record<string, Conversation>
  activeConversationId: string | null

  // Actions
  setActiveConversation: (id: string) => void
  createConversation: (data: Omit<Conversation, 'messages' | 'createdAt' | 'updatedAt'>) => void
  addMessage: (conversationId: string, message: Omit<Message, 'id' | 'timestamp'>) => void
  updateLastMessage: (conversationId: string, content: string) => void
  clearConversation: (conversationId: string) => void
  deleteConversation: (conversationId: string) => void
}
```

---

## WXT é…ç½®

### wxt.config.ts

```typescript
import { defineConfig } from 'wxt'

export default defineConfig({
  modules: ['@wxt-dev/module-react'],
  manifest: {
    name: 'Inquiry AI Assistant',
    description: 'AI å®¢æœé—®è¯¢åŠ©æ‰‹ - æ”¯æŒ Rakuten/Mercari/Amazon',
    permissions: ['storage', 'activeTab', 'sidePanel', 'tabs'],
    host_permissions: [
      'https://*.rakuten.co.jp/*',
      'https://*.mercari.com/*',
      'https://*.amazon.co.jp/*',
      'https://api.openai.com/*',
      'https://generativelanguage.googleapis.com/*',
      'https://api.zenmux.ai/*',
    ],
    side_panel: {
      default_path: 'sidepanel.html',
    },
    action: {
      default_title: 'æ‰“å¼€ AI åŠ©æ‰‹',
    },
  },
})
```

### Content Script é…ç½® (WXT é£æ ¼)

```typescript
// src/entrypoints/content.ts
export default defineContentScript({
  matches: [
    'https://rmesse.rms.rakuten.co.jp/*',
    'https://*.mercari.com/mypage/messages/*',
    'https://sellercentral.amazon.co.jp/*',
  ],
  main() {
    // æ£€æµ‹å¹³å°å¹¶æå–æ•°æ®
    const extractor = ExtractorFactory.create(location.href)
    if (extractor) {
      const data = extractor.extract()
      chrome.runtime.sendMessage({ type: 'INQUIRY_DATA', payload: data })
    }
  },
})
```

---

## ç”¨æˆ·ç•Œé¢è®¾è®¡

### Side Panel å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chrome æµè§ˆå™¨                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   Rakuten R-Messe é—®è¯¢é¡µé¢                      â”‚  â”‚ ğŸ¤– AI å®¢æœåŠ©æ‰‹     â”‚  â”‚
â”‚                                                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ å¯¹è¯åˆ—è¡¨           â”‚  â”‚
â”‚   â”‚  å®¢æˆ·é—®é¢˜å†…å®¹...                         â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚                                         â”‚   â”‚  â”‚ â”‚ğŸŸ¢ ç”°ä¸­å¤ªéƒ     â”‚ â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ â”‚âšª å±±ç”°èŠ±å­     â”‚ â”‚  â”‚
â”‚                                                 â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                                                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                                                 â”‚  â”‚ ğŸ“‹ é—®è¯¢ä¸Šä¸‹æ–‡      â”‚  â”‚
â”‚                                                 â”‚  â”‚ å®¢æˆ·: ç”°ä¸­å¤ªéƒ     â”‚  â”‚
â”‚                                                 â”‚  â”‚ ç±»åˆ«: é…é€é—®é¢˜     â”‚  â”‚
â”‚                                                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                                                 â”‚  â”‚                    â”‚  â”‚
â”‚                                                 â”‚  â”‚ ğŸ’¬ æ¶ˆæ¯åŒºåŸŸ        â”‚  â”‚
â”‚                                                 â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚                                                 â”‚  â”‚ â”‚ AI: æ‚¨å¥½...    â”‚ â”‚  â”‚
â”‚                                                 â”‚  â”‚ â”‚ [å¡«å……] [å¤åˆ¶]  â”‚ â”‚  â”‚
â”‚                                                 â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                                                 â”‚  â”‚                    â”‚  â”‚
â”‚                                                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                                                 â”‚  â”‚ å¿«æ·æ“ä½œ           â”‚  â”‚
â”‚                                                 â”‚  â”‚ [ç”Ÿæˆå›å¤][é“æ­‰]   â”‚  â”‚
â”‚                                                 â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                                                 â”‚  â”‚ [ğŸ“ è¾“å…¥æ¶ˆæ¯...]   â”‚  â”‚
â”‚                                                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äº¤äº’æµç¨‹

1. **æ‰“å¼€é—®è¯¢é¡µé¢** â†’ Content Script æ£€æµ‹å¹¶æå–æ•°æ®
2. **ç‚¹å‡»æ‰©å±•å›¾æ ‡** â†’ Side Panel æ‰“å¼€å¹¶è‡ªåŠ¨å…³è”å½“å‰é—®è¯¢
3. **é€‰æ‹©å¿«æ·æ“ä½œæˆ–è¾“å…¥** â†’ AI ç”Ÿæˆå›å¤ (æµå¼)
4. **Markdown æ¸²æŸ“** â†’ æ˜¾ç¤ºæ ¼å¼åŒ–çš„å›å¤
5. **ç‚¹å‡»"å¡«å……"** â†’ å›å¤è‡ªåŠ¨å¡«å…¥é¡µé¢è¾“å…¥æ¡†
6. **åˆ‡æ¢é—®è¯¢é¡µé¢** â†’ Side Panel è‡ªåŠ¨åˆ‡æ¢å¯¹è¯ä¸Šä¸‹æ–‡

---

## å¼€å‘è®¡åˆ’

| é˜¶æ®µ | å†…å®¹ | äº§å‡º | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| **Phase 1** | é¡¹ç›®æ­å»º | WXT + React åŸºç¡€æ¡†æ¶ | ğŸ”´ é«˜ |
| **Phase 2** | Side Panel åŸºç¡€ | ç©ºå£³ç•Œé¢ï¼Œå¯æ­£å¸¸æ‰“å¼€ | ğŸ”´ é«˜ |
| **Phase 3** | è®¾ç½®é¡µé¢ | API é…ç½® + è¯­è¨€åˆ‡æ¢ + æ¨¡å‹é€‰æ‹© | ğŸ”´ é«˜ |
| **Phase 4** | ChatPanel ç»„ä»¶ | Bubble + Sender + Markdown æ¸²æŸ“ | ğŸ”´ é«˜ |
| **Phase 5** | useXChat é›†æˆ | èƒ½ä¸ AI å¯¹è¯ (æµå¼) | ğŸ”´ é«˜ |
| **Phase 6** | Rakuten Extractor | æŠ“å–é—®è¯¢æ•°æ® + å¡«å……å›å¤ | ğŸ”´ é«˜ |
| **Phase 7** | å¯¹è¯ç®¡ç† | Zustand + å¤šå¯¹è¯åˆ‡æ¢ | ğŸŸ¡ ä¸­ |
| **Phase 8** | å¤šè¯­è¨€æ”¯æŒ | ä¸­æ–‡/æ—¥è¯­/è‹±è¯­ å›½é™…åŒ– (i18n) | ğŸŸ¡ ä¸­ |
| **Phase 9** | ä¼˜åŒ–æ‰“ç£¨ | UI ç»†èŠ‚ã€é”™è¯¯å¤„ç†ã€æ€§èƒ½ä¼˜åŒ– | ğŸŸ¡ ä¸­ |
| **Phase 10** | Mercari Extractor | ç…¤ç‚‰å¹³å°æ”¯æŒ | ğŸŸ¢ ä½ |
| **Phase 11** | Amazon Extractor | Amazon å¹³å°æ”¯æŒ | ğŸŸ¢ ä½ |

> **å¼€å‘ç­–ç•¥**:
> - Phase 1-6 ä¸ºæ ¸å¿ƒåŠŸèƒ½ï¼Œä¼˜å…ˆå®Œæˆ Rakuten å¹³å°çš„å®Œæ•´ä½“éªŒ
> - Phase 7-9 ä¸ºåŠŸèƒ½å®Œå–„å’Œæ‰“ç£¨
> - Phase 10-11 ä¸ºå¹³å°æ‰©å±•ï¼Œåœ¨ Rakuten ç¨³å®šåå†è¿›è¡Œ

---

### Phase 3: è®¾ç½®é¡µé¢è¯¦ç»†è®¾è®¡

#### è®¾ç½®é¡¹åˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è®¾ç½®é¡µé¢                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸŒ ç•Œé¢è®¾ç½®                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  è¯­è¨€        [ä¸­æ–‡ â–¼]                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  ä¸»é¢˜        [è·Ÿéšç³»ç»Ÿ â–¼]  (æµ…è‰²/æ·±è‰²/è·Ÿéšç³»ç»Ÿ)          â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ¤– AI æœåŠ¡é…ç½®                                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  æœåŠ¡å•†      [OpenAI å…¼å®¹ â–¼]                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚              (OpenAI / Gemini / è‡ªå®šä¹‰)                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  API URL     [https://api.openai.com/v1          ]      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  API Key     [sk-xxxxxxxxxxxxx                   ] ğŸ‘   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  æ¨¡å‹        [gpt-4o â–¼]                                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚              (gpt-4o / gpt-4o-mini / è‡ªå®šä¹‰è¾“å…¥)         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  [æµ‹è¯•è¿æ¥]                                              â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ’¬ å¯¹è¯è®¾ç½®                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Temperature  [0.7]  â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Max Tokens   [4096]                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  æµå¼è¾“å‡º     [âœ“] å¯ç”¨                                   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“ æç¤ºè¯æ¨¡æ¿ (å¯é€‰)                                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  ç³»ç»Ÿæç¤ºè¯  [å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†...]                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  [æ¢å¤é»˜è®¤]                                              â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                                        [ä¿å­˜è®¾ç½®]  [é‡ç½®]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è®¾ç½®å­˜å‚¨ç»“æ„

```typescript
// src/stores/settings.ts
import { create } from 'zustand'
import { persist } from 'zustand/middleware'

export type Language = 'zh' | 'ja' | 'en'
export type Theme = 'light' | 'dark' | 'system'
export type Provider = 'openai' | 'gemini' | 'custom'

export interface SettingsState {
  // ç•Œé¢è®¾ç½®
  language: Language
  theme: Theme

  // AI æœåŠ¡é…ç½®
  provider: Provider
  apiUrl: string
  apiKey: string
  model: string

  // å¯¹è¯è®¾ç½®
  temperature: number
  maxTokens: number
  streamEnabled: boolean

  // æç¤ºè¯æ¨¡æ¿
  systemPrompt: string

  // Actions
  setLanguage: (lang: Language) => void
  setTheme: (theme: Theme) => void
  setProvider: (provider: Provider) => void
  setApiConfig: (config: { apiUrl?: string; apiKey?: string; model?: string }) => void
  setDialogSettings: (settings: { temperature?: number; maxTokens?: number; streamEnabled?: boolean }) => void
  setSystemPrompt: (prompt: string) => void
  resetToDefaults: () => void
}

const defaultSettings = {
  language: 'ja' as Language,
  theme: 'system' as Theme,
  provider: 'openai' as Provider,
  apiUrl: 'https://api.openai.com/v1',
  apiKey: '',
  model: 'gpt-4o-mini',
  temperature: 0.7,
  maxTokens: 4096,
  streamEnabled: true,
  systemPrompt: '',
}

export const useSettingsStore = create<SettingsState>()(
  persist(
    (set) => ({
      ...defaultSettings,

      setLanguage: (language) => set({ language }),
      setTheme: (theme) => set({ theme }),
      setProvider: (provider) => {
        // åˆ‡æ¢æœåŠ¡å•†æ—¶é‡ç½® URL
        const urls: Record<Provider, string> = {
          openai: 'https://api.openai.com/v1',
          gemini: 'https://generativelanguage.googleapis.com/v1beta',
          custom: '',
        }
        set({ provider, apiUrl: urls[provider] })
      },
      setApiConfig: (config) => set((state) => ({ ...state, ...config })),
      setDialogSettings: (settings) => set((state) => ({ ...state, ...settings })),
      setSystemPrompt: (systemPrompt) => set({ systemPrompt }),
      resetToDefaults: () => set(defaultSettings),
    }),
    {
      name: 'inquiry-ai-settings',
      storage: {
        getItem: async (name) => {
          const result = await chrome.storage.local.get(name)
          return result[name] ?? null
        },
        setItem: async (name, value) => {
          await chrome.storage.local.set({ [name]: value })
        },
        removeItem: async (name) => {
          await chrome.storage.local.remove(name)
        },
      },
    }
  )
)
```

#### è®¾ç½®é¡µé¢ç»„ä»¶

```typescript
// src/components/Settings/index.tsx
import { Form, Input, Select, Slider, Switch, Button, message, Tabs } from 'antd'
import { useSettingsStore } from '@/stores/settings'
import { useI18n } from '@/hooks/useI18n'

export function SettingsPanel() {
  const { t } = useI18n()
  const settings = useSettingsStore()
  const [form] = Form.useForm()

  const handleTestConnection = async () => {
    try {
      // æµ‹è¯• API è¿æ¥
      const response = await fetch(`${settings.apiUrl}/models`, {
        headers: { Authorization: `Bearer ${settings.apiKey}` },
      })
      if (response.ok) {
        message.success(t('connectionSuccess'))
      } else {
        message.error(t('connectionFailed'))
      }
    } catch {
      message.error(t('connectionError'))
    }
  }

  return (
    <div className="p-4">
      <Tabs
        items={[
          {
            key: 'interface',
            label: t('interfaceSettings'),
            children: (
              <Form layout="vertical">
                <Form.Item label={t('language')}>
                  <Select
                    value={settings.language}
                    onChange={settings.setLanguage}
                    options={[
                      { value: 'zh', label: 'ä¸­æ–‡' },
                      { value: 'ja', label: 'æ—¥æœ¬èª' },
                      { value: 'en', label: 'English' },
                    ]}
                  />
                </Form.Item>
                <Form.Item label={t('theme')}>
                  <Select
                    value={settings.theme}
                    onChange={settings.setTheme}
                    options={[
                      { value: 'system', label: t('themeSystem') },
                      { value: 'light', label: t('themeLight') },
                      { value: 'dark', label: t('themeDark') },
                    ]}
                  />
                </Form.Item>
              </Form>
            ),
          },
          {
            key: 'ai',
            label: t('aiSettings'),
            children: (
              <Form layout="vertical">
                <Form.Item label={t('provider')}>
                  <Select
                    value={settings.provider}
                    onChange={settings.setProvider}
                    options={[
                      { value: 'openai', label: 'OpenAI' },
                      { value: 'gemini', label: 'Google Gemini' },
                      { value: 'custom', label: t('customProvider') },
                    ]}
                  />
                </Form.Item>
                <Form.Item label={t('apiUrl')}>
                  <Input
                    value={settings.apiUrl}
                    onChange={(e) => settings.setApiConfig({ apiUrl: e.target.value })}
                    placeholder="https://api.openai.com/v1"
                  />
                </Form.Item>
                <Form.Item label={t('apiKey')}>
                  <Input.Password
                    value={settings.apiKey}
                    onChange={(e) => settings.setApiConfig({ apiKey: e.target.value })}
                    placeholder="sk-..."
                  />
                </Form.Item>
                <Form.Item label={t('model')}>
                  <Select
                    value={settings.model}
                    onChange={(model) => settings.setApiConfig({ model })}
                    options={[
                      { value: 'gpt-4o', label: 'GPT-4o' },
                      { value: 'gpt-4o-mini', label: 'GPT-4o Mini' },
                      { value: 'gpt-4-turbo', label: 'GPT-4 Turbo' },
                    ]}
                    showSearch
                    allowClear
                  />
                </Form.Item>
                <Button onClick={handleTestConnection}>{t('testConnection')}</Button>
              </Form>
            ),
          },
          {
            key: 'dialog',
            label: t('dialogSettings'),
            children: (
              <Form layout="vertical">
                <Form.Item label={`Temperature: ${settings.temperature}`}>
                  <Slider
                    min={0}
                    max={2}
                    step={0.1}
                    value={settings.temperature}
                    onChange={(v) => settings.setDialogSettings({ temperature: v })}
                  />
                </Form.Item>
                <Form.Item label={t('maxTokens')}>
                  <Input
                    type="number"
                    value={settings.maxTokens}
                    onChange={(e) => settings.setDialogSettings({ maxTokens: Number(e.target.value) })}
                  />
                </Form.Item>
                <Form.Item label={t('streamOutput')}>
                  <Switch
                    checked={settings.streamEnabled}
                    onChange={(v) => settings.setDialogSettings({ streamEnabled: v })}
                  />
                </Form.Item>
              </Form>
            ),
          },
        ]}
      />
    </div>
  )
}
```

#### åº”ç”¨å†…è¯­è¨€åˆ‡æ¢å®ç°

ç”±äºéœ€è¦æ”¯æŒåº”ç”¨å†…è¯­è¨€åˆ‡æ¢ï¼ˆä¸ä¾èµ–æµè§ˆå™¨è®¾ç½®ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨ **æ··åˆæ–¹æ¡ˆ**ï¼š

```typescript
// src/utils/i18n.ts
import { useSettingsStore } from '@/stores/settings'

// ç¿»è¯‘æ•°æ® (å†…åµŒï¼Œé¿å…å¼‚æ­¥åŠ è½½)
const translations: Record<string, Record<string, string>> = {
  zh: {
    settings: 'è®¾ç½®',
    save: 'ä¿å­˜',
    cancel: 'å–æ¶ˆ',
    language: 'è¯­è¨€',
    theme: 'ä¸»é¢˜',
    // ... æ›´å¤šç¿»è¯‘
  },
  ja: {
    settings: 'è¨­å®š',
    save: 'ä¿å­˜',
    cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
    language: 'è¨€èª',
    theme: 'ãƒ†ãƒ¼ãƒ',
    // ...
  },
  en: {
    settings: 'Settings',
    save: 'Save',
    cancel: 'Cancel',
    language: 'Language',
    theme: 'Theme',
    // ...
  },
}

/**
 * è·å–ç¿»è¯‘ - ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·è®¾ç½®çš„è¯­è¨€
 */
export function t(key: string, ...args: string[]): string {
  const lang = useSettingsStore.getState().language
  let text = translations[lang]?.[key] || translations['ja']?.[key] || key

  // å¤„ç†å‚æ•°æ›¿æ¢ {0}, {1}, ...
  args.forEach((arg, i) => {
    text = text.replace(`{${i}}`, arg)
  })

  return text
}

/**
 * React Hook ç‰ˆæœ¬
 */
export function useI18n() {
  const language = useSettingsStore((s) => s.language)

  const translate = (key: string, ...args: string[]) => {
    let text = translations[language]?.[key] || translations['ja']?.[key] || key
    args.forEach((arg, i) => {
      text = text.replace(`{${i}}`, arg)
    })
    return text
  }

  return { t: translate, language }
}
```

#### è¯­è¨€åˆ‡æ¢å³æ—¶ç”Ÿæ•ˆ

```typescript
// src/sidepanel/App.tsx
import { ConfigProvider } from 'antd'
import zhCN from 'antd/locale/zh_CN'
import jaJP from 'antd/locale/ja_JP'
import enUS from 'antd/locale/en_US'
import { useSettingsStore } from '@/stores/settings'

const locales = {
  zh: zhCN,
  ja: jaJP,
  en: enUS,
}

export function App() {
  const language = useSettingsStore((s) => s.language)

  return (
    <ConfigProvider locale={locales[language]}>
      {/* ... */}
    </ConfigProvider>
  )
}
```

### Phase 11: å¤šè¯­è¨€å®ç°æ–¹æ¡ˆ

> å‚è€ƒ [WXT i18n å®˜æ–¹æ–‡æ¡£](https://wxt.dev/guide/essentials/i18n.html)

#### æŠ€æœ¯é€‰å‹

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨è |
|------|------|------|------|
| **browser.i18n (WXT åŸç”Ÿ)** | åŒæ­¥åŠ è½½ã€ä½“ç§¯å°ã€æ”¯æŒ manifest æœ¬åœ°åŒ– | æ ¼å¼å›ºå®š | âœ… æ¨è |
| i18next + react-i18next | åŠŸèƒ½å…¨é¢ã€ç”Ÿæ€æˆç†Ÿ | é¢å¤–ä¾èµ–ã€æ— æ³•æœ¬åœ°åŒ– manifest | å¤‡é€‰ |

**WXT æ¨èä½¿ç”¨ Chrome Extension åŸç”Ÿ `browser.i18n` API**ï¼Œä¼˜åŠ¿ï¼š
- ç¿»è¯‘åŒæ­¥åŠ è½½ï¼Œæ— é—ªçƒ
- ä¸ä¼šé‡å¤æ‰“åŒ…ï¼Œä¿æŒæ‰©å±•ä½“ç§¯å°
- æ”¯æŒ manifest å’Œ CSS æ–‡ä»¶çš„æœ¬åœ°åŒ–

#### ç›®å½•ç»“æ„ (WXT è§„èŒƒ)

```
public/
â””â”€â”€ _locales/
    â”œâ”€â”€ zh_CN/                    # ä¸­æ–‡ (ç®€ä½“)
    â”‚   â””â”€â”€ messages.json
    â”œâ”€â”€ ja/                       # æ—¥è¯­ (é»˜è®¤)
    â”‚   â””â”€â”€ messages.json
    â””â”€â”€ en/                       # è‹±è¯­
        â””â”€â”€ messages.json
```

#### WXT é…ç½®

```typescript
// wxt.config.ts
import { defineConfig } from 'wxt'

export default defineConfig({
  modules: ['@wxt-dev/module-react'],
  manifest: {
    name: '__MSG_extName__',              // ä½¿ç”¨ i18n é­”æ³•å­—ç¬¦ä¸²
    description: '__MSG_extDescription__',
    default_locale: 'ja',                  // é»˜è®¤è¯­è¨€ï¼šæ—¥è¯­
    // ...
  },
})
```

#### è¯­è¨€æ–‡ä»¶æ ¼å¼ (messages.json)

```json
// public/_locales/zh_CN/messages.json
{
  "extName": {
    "message": "AI å®¢æœåŠ©æ‰‹"
  },
  "extDescription": {
    "message": "å¤šå¹³å°ç”µå•†å®¢æœ AI åŠ©æ‰‹ - æ”¯æŒ Rakuten/Mercari/Amazon"
  },
  "settings": {
    "message": "è®¾ç½®"
  },
  "save": {
    "message": "ä¿å­˜"
  },
  "cancel": {
    "message": "å–æ¶ˆ"
  },
  "confirm": {
    "message": "ç¡®è®¤"
  },
  "delete": {
    "message": "åˆ é™¤"
  },
  "copy": {
    "message": "å¤åˆ¶"
  },
  "copied": {
    "message": "å·²å¤åˆ¶"
  },
  "fill": {
    "message": "å¡«å……"
  },
  "filled": {
    "message": "å·²å¡«å……"
  },
  "loading": {
    "message": "åŠ è½½ä¸­..."
  },
  "error": {
    "message": "é”™è¯¯"
  },
  "retry": {
    "message": "é‡è¯•"
  },
  "welcomeTitle": {
    "message": "AI å®¢æœåŠ©æ‰‹"
  },
  "welcomeDescription": {
    "message": "æˆ‘å¯ä»¥å¸®æ‚¨å¿«é€Ÿç”Ÿæˆä¸“ä¸šçš„å®¢æœå›å¤"
  },
  "promptGenerateReply": {
    "message": "ç”Ÿæˆå›å¤"
  },
  "promptApologize": {
    "message": "ç¤¼è²Œé“æ­‰"
  },
  "promptConfirmOrder": {
    "message": "ç¡®è®¤è®¢å•"
  },
  "promptShippingQuery": {
    "message": "ç‰©æµæŸ¥è¯¢"
  },
  "contextTitle": {
    "message": "é—®è¯¢ä¸Šä¸‹æ–‡"
  },
  "contextCustomer": {
    "message": "å®¢æˆ·"
  },
  "contextCategory": {
    "message": "ç±»åˆ«"
  },
  "contextOrderNumber": {
    "message": "è®¢å•å·"
  },
  "inputPlaceholder": {
    "message": "è¾“å…¥æ¶ˆæ¯ï¼ŒæŒ‰ Enter å‘é€..."
  },
  "inputInitializing": {
    "message": "æ­£åœ¨åˆå§‹åŒ–..."
  },
  "messagesCount": {
    "message": "$COUNT$ æ¡æ¶ˆæ¯",
    "placeholders": {
      "count": {
        "content": "$1"
      }
    }
  },
  "messagesClearConfirm": {
    "message": "ç¡®å®šæ¸…ç©ºå¯¹è¯ï¼Ÿ"
  }
}
```

```json
// public/_locales/ja/messages.json
{
  "extName": {
    "message": "AI ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ"
  },
  "extDescription": {
    "message": "ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  EC ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ"
  },
  "settings": {
    "message": "è¨­å®š"
  },
  "save": {
    "message": "ä¿å­˜"
  },
  "cancel": {
    "message": "ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
  },
  "confirm": {
    "message": "ç¢ºèª"
  },
  "delete": {
    "message": "å‰Šé™¤"
  },
  "copy": {
    "message": "ã‚³ãƒ”ãƒ¼"
  },
  "copied": {
    "message": "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"
  },
  "fill": {
    "message": "å…¥åŠ›"
  },
  "filled": {
    "message": "å…¥åŠ›ã—ã¾ã—ãŸ"
  },
  "loading": {
    "message": "èª­ã¿è¾¼ã¿ä¸­..."
  },
  "error": {
    "message": "ã‚¨ãƒ©ãƒ¼"
  },
  "retry": {
    "message": "å†è©¦è¡Œ"
  },
  "welcomeTitle": {
    "message": "AI ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ"
  },
  "welcomeDescription": {
    "message": "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªè¿”ä¿¡ã‚’ç´ æ—©ãç”Ÿæˆã—ã¾ã™"
  },
  "promptGenerateReply": {
    "message": "è¿”ä¿¡ã‚’ç”Ÿæˆ"
  },
  "promptApologize": {
    "message": "ãŠè©«ã³"
  },
  "promptConfirmOrder": {
    "message": "æ³¨æ–‡ç¢ºèª"
  },
  "promptShippingQuery": {
    "message": "é…é€ç¢ºèª"
  },
  "contextTitle": {
    "message": "ãŠå•ã„åˆã‚ã›æƒ…å ±"
  },
  "contextCustomer": {
    "message": "ãŠå®¢æ§˜"
  },
  "contextCategory": {
    "message": "ã‚«ãƒ†ã‚´ãƒªãƒ¼"
  },
  "contextOrderNumber": {
    "message": "æ³¨æ–‡ç•ªå·"
  },
  "inputPlaceholder": {
    "message": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ Enter ã§é€ä¿¡..."
  },
  "inputInitializing": {
    "message": "åˆæœŸåŒ–ä¸­..."
  },
  "messagesCount": {
    "message": "$COUNT$ ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
    "placeholders": {
      "count": {
        "content": "$1"
      }
    }
  },
  "messagesClearConfirm": {
    "message": "ä¼šè©±ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ"
  }
}
```

```json
// public/_locales/en/messages.json
{
  "extName": {
    "message": "AI Customer Support"
  },
  "extDescription": {
    "message": "Multi-platform E-commerce Customer Support AI Assistant"
  },
  "settings": {
    "message": "Settings"
  },
  "save": {
    "message": "Save"
  },
  "cancel": {
    "message": "Cancel"
  },
  "confirm": {
    "message": "Confirm"
  },
  "delete": {
    "message": "Delete"
  },
  "copy": {
    "message": "Copy"
  },
  "copied": {
    "message": "Copied"
  },
  "fill": {
    "message": "Fill"
  },
  "filled": {
    "message": "Filled"
  },
  "loading": {
    "message": "Loading..."
  },
  "error": {
    "message": "Error"
  },
  "retry": {
    "message": "Retry"
  },
  "welcomeTitle": {
    "message": "AI Customer Support"
  },
  "welcomeDescription": {
    "message": "I can help you generate professional replies quickly"
  },
  "promptGenerateReply": {
    "message": "Generate Reply"
  },
  "promptApologize": {
    "message": "Apologize"
  },
  "promptConfirmOrder": {
    "message": "Confirm Order"
  },
  "promptShippingQuery": {
    "message": "Shipping Query"
  },
  "contextTitle": {
    "message": "Inquiry Context"
  },
  "contextCustomer": {
    "message": "Customer"
  },
  "contextCategory": {
    "message": "Category"
  },
  "contextOrderNumber": {
    "message": "Order Number"
  },
  "inputPlaceholder": {
    "message": "Type a message, press Enter to send..."
  },
  "inputInitializing": {
    "message": "Initializing..."
  },
  "messagesCount": {
    "message": "$COUNT$ messages",
    "placeholders": {
      "count": {
        "content": "$1"
      }
    }
  },
  "messagesClearConfirm": {
    "message": "Clear conversation?"
  }
}
```

#### å°è£… i18n å·¥å…·å‡½æ•°

```typescript
// src/utils/i18n.ts

/**
 * è·å–ç¿»è¯‘æ–‡æœ¬
 * @param key ç¿»è¯‘é”®
 * @param substitutions æ›¿æ¢å‚æ•°
 */
export function t(key: string, ...substitutions: string[]): string {
  return browser.i18n.getMessage(key, substitutions)
}

/**
 * è·å–å½“å‰è¯­è¨€
 */
export function getCurrentLocale(): string {
  return browser.i18n.getUILanguage()
}

/**
 * æ£€æŸ¥æ˜¯å¦ä¸ºä¸­æ–‡ç¯å¢ƒ
 */
export function isChineseLocale(): boolean {
  const locale = getCurrentLocale()
  return locale.startsWith('zh')
}

/**
 * æ£€æŸ¥æ˜¯å¦ä¸ºæ—¥è¯­ç¯å¢ƒ
 */
export function isJapaneseLocale(): boolean {
  const locale = getCurrentLocale()
  return locale.startsWith('ja')
}
```

#### React Hook å°è£…

```typescript
// src/hooks/useI18n.ts
import { useMemo } from 'react'

export function useI18n() {
  const locale = useMemo(() => browser.i18n.getUILanguage(), [])

  const t = (key: string, ...substitutions: string[]) => {
    return browser.i18n.getMessage(key, substitutions)
  }

  return { t, locale }
}
```

#### ç»„ä»¶ä¸­ä½¿ç”¨

```typescript
// src/components/ChatPanel/index.tsx
import { useI18n } from '@/hooks/useI18n'

export function ChatPanel() {
  const { t } = useI18n()

  return (
    <div>
      <h1>{t('welcomeTitle')}</h1>
      <p>{t('welcomeDescription')}</p>

      <Sender
        placeholder={t('inputPlaceholder')}
        // ...
      />

      <Button onClick={handleFill}>
        {t('fill')}
      </Button>

      {/* å¸¦å‚æ•°çš„ç¿»è¯‘ */}
      <span>{t('messagesCount', String(messages.length))}</span>
    </div>
  )
}
```

#### CSS ä¸­ä½¿ç”¨ (å¯é€‰)

```css
/* ä½¿ç”¨ __MSG_key__ è¯­æ³• */
.extension-name::before {
  content: "__MSG_extName__";
}
```

#### æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ | ä»£ç  | ç›®å½•å | ä¸»è¦ç”¨æˆ· |
|------|------|--------|----------|
| ä¸­æ–‡ (ç®€ä½“) | `zh-CN` | `zh_CN` | å†…éƒ¨è¿è¥äººå‘˜ |
| æ—¥è¯­ | `ja` | `ja` | æ—¥æœ¬å®¢æœã€ç³»ç»Ÿé»˜è®¤ |
| è‹±è¯­ | `en` | `en` | å›½é™…åŒ–æ”¯æŒ |

#### æ³¨æ„äº‹é¡¹

1. **è¯­è¨€ç”±æµè§ˆå™¨å†³å®š** - Chrome Extension çš„è¯­è¨€è·Ÿéšæµè§ˆå™¨è®¾ç½®ï¼Œæ— æ³•åœ¨æ‰©å±•å†…åˆ‡æ¢
2. **ç›®å½•å‘½å** - ä½¿ç”¨ä¸‹åˆ’çº¿ `zh_CN` è€Œéè¿å­—ç¬¦ `zh-CN`
3. **default_locale å¿…å¡«** - åœ¨ `wxt.config.ts` ä¸­å¿…é¡»è®¾ç½®
4. **åŒæ­¥åŠ è½½** - `browser.i18n.getMessage()` æ˜¯åŒæ­¥çš„ï¼Œæ— éœ€ async/await

---

## ç›¸æ¯”å…¶ä»–æ–¹æ¡ˆçš„ä¼˜åŠ¿

| å¯¹æ¯”é¡¹ | Plasmo | CRXJS | WXT (æ¨è) |
|--------|--------|-------|------------|
| ç»´æŠ¤çŠ¶æ€ | âš ï¸ ç»´æŠ¤æ¨¡å¼ | âš ï¸ Beta | âœ… æ´»è·ƒ |
| æ„å»ºé€Ÿåº¦ | æ…¢ (Parcel) | å¿« (Vite) | å¿« (Vite) |
| HMR çƒ­æ›´æ–° | ä¸ç¨³å®š | ä¼˜ç§€ | ä¼˜ç§€ |
| è·¨æµè§ˆå™¨ | æ”¯æŒ | ä»… Chrome | âœ… å…¨å¹³å° |
| æ¡†æ¶é€‰æ‹© | React ä¼˜å…ˆ | æ¡†æ¶æ— å…³ | æ¡†æ¶æ— å…³ |
| Tree-shaking | ä¸€èˆ¬ | å¥½ | âœ… æœ€ä¼˜ |
| æ–‡æ¡£è´¨é‡ | å¥½ | ä¸€èˆ¬ | âœ… ä¼˜ç§€ |
| ç¤¾åŒºæ´»è·ƒåº¦ | ä¸‹é™ | ä¸€èˆ¬ | âœ… æ´»è·ƒ |

---

## å‚è€ƒèµ„æº

- [WXT å®˜ç½‘](https://wxt.dev/)
- [WXT GitHub](https://github.com/wxt-dev/wxt)
- [Ant Design X å®˜ç½‘](https://x.ant.design/)
- [Ant Design X Copilot Demo](https://x.ant.design/docs/playground/copilot-cn)
- [Ant Design ä¸»åº“](https://ant-design.antgroup.com/)
- [Chrome Side Panel API](https://developer.chrome.com/docs/extensions/reference/api/sidePanel)
- [Zustand](https://zustand-demo.pmnd.rs/)
